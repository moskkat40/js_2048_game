var t,e,r,i,s,n;t=new(function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0]];(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.grid=t,this.score=0,this.status="idle"}return t=[{key:"moveLeft",value:function(){for(var t=this,e=0;e<this.grid.length;e++)!function(e){for(var r=t.grid[e].filter(function(t){return t>0}),i=0;i<r.length-1;i++)r[i]===r[i+1]&&(r[i]*=2,r[i+1]=0,t.score+=r[i]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.push(0);t.grid[e]=r}(e);this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}},{key:"moveRight",value:function(){for(var t=this,e=0;e<this.grid.length;e++)!function(e){for(var r=t.grid[e].filter(function(t){return t>0}),i=r.length-1;i>0;i--)r[i]===r[i-1]&&(r[i]*=2,r[i-1]=0,t.score+=r[i]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.unshift(0);t.grid[e]=r}(e);this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}},{key:"moveUp",value:function(){for(var t=this,e=0;e<this.grid[0].length;e++)!function(e){for(var r=[],i=0;i<t.grid.length;i++)t.grid[i][e]>0&&r.push(t.grid[i][e]);for(var s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,r[s+1]=0,t.score+=r[s]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.push(0);for(var n=0;n<t.grid.length;n++)t.grid[n][e]=r[n]}(e);this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}},{key:"moveDown",value:function(){for(var t=this,e=0;e<this.grid.length;e++)!function(e){for(var r=[],i=0;i<t.grid.length;i++)t.grid[i][e]>0&&r.push(t.grid[i][e]);for(var s=r.length-1;s>0;s--)r[s]===r[s-1]&&(r[s]*=2,r[s-1]=0,t.score+=r[s]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.unshift(0);for(var n=0;n<t.grid.length;n++)t.grid[n][e]=r[n]||0}(e);this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}},{key:"checkWin",value:function(){for(var t=0;t<this.grid.length;t++)for(var e=0;e<this.grid[t].length;e++)if(2048===this.grid[t][e])return this.status="win",!0;return this.status="playing",!1}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.grid}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.updateDOM(),this.addStartCell(),this.addStartCell()}},{key:"restart",value:function(){document.querySelectorAll(".field-cell").forEach(function(t){t.innerHTML="",t.className="field-cell"}),this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.updateDOM()}},{key:"addStartCell",value:function(){var t=Math.random()>=.9?4:2;if(0!==this.grid.flat().filter(function(t){return 0===t}).length)for(var e=!1;!e;)try{var r=Math.floor(4*Math.random()),i=Math.floor(4*Math.random());this.grid[r]&&0===this.grid[r][i]&&(this.grid[r][i]=t,this.updateDOM(),e=!0)}catch(t){return}}},{key:"updateDOM",value:function(){for(var t=document.querySelectorAll(".field-cell"),e=0;e<this.grid.length;e++)for(var r=0;r<this.grid[e].length;r++){var i=t[4*e+r],s=this.grid[e][r];i.className="field-cell",i.innerHTML="",s>0&&(i.classList.add("field-cell--".concat(s)),i.innerHTML=s)}}},{key:"checkLose",value:function(){for(var t=0;t<this.grid.length;t++)for(var e=0;e<this.grid[t].length;e++)if(0===this.grid[t][e])return this.status="playing",!1;for(var r=0;r<this.grid.length;r++)for(var i=0;i<this.grid[r].length;i++)if(r>0&&this.grid[r][i]===this.grid[r-1][i]||r<this.grid.length-1&&this.grid[r][i]===this.grid[r+1][i]||i>0&&this.grid[r][i]===this.grid[r][i-1]||i<this.grid[r].length-1&&this.grid[r][i]===this.grid[r][i+1])return this.status="playing",!1;return this.status="lose",!0}}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(e.prototype,t),e}()),e=document.querySelector(".button.start"),r=document.querySelector(".message.message-start"),i=document.querySelector(".message.message-lose"),s=document.querySelector(".message.message-win"),n=document.querySelector(".game-score"),document.addEventListener("keydown",function(e){"ArrowLeft"===e.key?(t.moveLeft(),n.innerText=t.score):"ArrowRight"===e.key?(t.moveRight(),n.innerText=t.score):"ArrowUp"===e.key?(t.moveUp(),n.innerText=t.score):"ArrowDown"===e.key&&(t.moveDown(),n.innerText=t.score),"lose"===t.getStatus()&&(i.classList.remove("hidden"),r.classList.add("hidden")),"win"===t.getStatus()&&(s.classList.remove("hidden"),r.classList.add("hidden"))}),e.addEventListener("click",function(){e.classList.contains("restart")?(e.classList.replace("restart","start"),e.innerHTML="Start",r.classList.remove("hidden"),i.classList.add("hidden"),n.innerText=0,t.restart()):(e.classList.replace("start","restart"),e.innerHTML="Restart",t.start(),r.classList.add("hidden"),i.classList.add("hidden"))});
//# sourceMappingURL=index.83758c5b.js.map
