const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.grid=t,this.score=0,this.status="idle"}moveLeft(){for(let t=0;t<this.grid.length;t++){let e=this.grid[t].filter(t=>t>0);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);this.grid[t]=e}this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}moveRight(){for(let t=0;t<this.grid.length;t++){let e=this.grid[t].filter(t=>t>0);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.unshift(0);this.grid[t]=e}this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}moveUp(){for(let t=0;t<this.grid[0].length;t++){let e=[];for(let s=0;s<this.grid.length;s++)this.grid[s][t]>0&&e.push(this.grid[s][t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);for(let s=0;s<this.grid.length;s++)this.grid[s][t]=e[s]}this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}moveDown(){for(let t=0;t<this.grid.length;t++){let e=[];for(let s=0;s<this.grid.length;s++)this.grid[s][t]>0&&e.push(this.grid[s][t]);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.unshift(0);for(let s=0;s<this.grid.length;s++)this.grid[s][t]=e[s]||0}this.updateDOM(),this.checkWin(),"playing"===this.status&&(this.addStartCell(),this.checkLose())}checkWin(){for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(2048===this.grid[t][e])return this.status="win",!0;return this.status="playing",!1}getScore(){return this.score}getState(){return this.grid}getStatus(){return this.status}start(){this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="playing",this.updateDOM(),this.addStartCell(),this.addStartCell()}restart(){document.querySelectorAll(".field-cell").forEach(t=>{t.innerHTML="",t.className="field-cell"}),this.grid=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle",this.updateDOM()}addStartCell(){let t=Math.random()>=.9?4:2;if(0===this.grid.flat().filter(t=>0===t).length)return;let e=!1;for(;!e;)try{let s=Math.floor(4*Math.random()),i=Math.floor(4*Math.random());this.grid[s]&&0===this.grid[s][i]&&(this.grid[s][i]=t,this.updateDOM(),e=!0)}catch(t){return}}updateDOM(){let t=document.querySelectorAll(".field-cell");for(let e=0;e<this.grid.length;e++)for(let s=0;s<this.grid[e].length;s++){let i=t[4*e+s],r=this.grid[e][s];i.className="field-cell",i.innerHTML="",r>0&&(i.classList.add(`field-cell--${r}`),i.innerHTML=r)}}checkLose(){for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(0===this.grid[t][e])return this.status="playing",!1;for(let t=0;t<this.grid.length;t++)for(let e=0;e<this.grid[t].length;e++)if(t>0&&this.grid[t][e]===this.grid[t-1][e]||t<this.grid.length-1&&this.grid[t][e]===this.grid[t+1][e]||e>0&&this.grid[t][e]===this.grid[t][e-1]||e<this.grid[t].length-1&&this.grid[t][e]===this.grid[t][e+1])return this.status="playing",!1;return this.status="lose",!0}},e=document.querySelector(".button.start"),s=document.querySelector(".message.message-start"),i=document.querySelector(".message.message-lose"),r=document.querySelector(".message.message-win"),h=document.querySelector(".game-score");document.addEventListener("keydown",e=>{"ArrowLeft"===e.key?(t.moveLeft(),h.innerText=t.score):"ArrowRight"===e.key?(t.moveRight(),h.innerText=t.score):"ArrowUp"===e.key?(t.moveUp(),h.innerText=t.score):"ArrowDown"===e.key&&(t.moveDown(),h.innerText=t.score),"lose"===t.getStatus()&&(i.classList.remove("hidden"),s.classList.add("hidden")),"win"===t.getStatus()&&(r.classList.remove("hidden"),s.classList.add("hidden"))}),e.addEventListener("click",()=>{e.classList.contains("restart")?(e.classList.replace("restart","start"),e.innerHTML="Start",s.classList.remove("hidden"),i.classList.add("hidden"),h.innerText=0,t.restart()):(e.classList.replace("start","restart"),e.innerHTML="Restart",t.start(),s.classList.add("hidden"),i.classList.add("hidden"))});
//# sourceMappingURL=index.1f49bc4d.js.map
